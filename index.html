<!doctype html>
<html lang="ar" dir="rtl">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>TRAGO AVATAR â€” Majoodi</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
      body { background: linear-gradient(180deg,#ecfeff,#ffffff,#eff6ff); }
      details > summary { cursor: pointer; }
      code, .code { direction:ltr; unicode-bidi: embed; }
    </style>
  </head>
  <body class="min-h-screen text-gray-900">
    <header class="sticky top-0 z-10 bg-white/70 backdrop-blur border-b">
      <div class="max-w-5xl mx-auto px-4 py-3 flex items-center justify-between">
        <h1 class="text-xl font-extrabold bg-gradient-to-r from-cyan-500 to-blue-600 bg-clip-text text-transparent">
          TRAGO AVATAR
        </h1>
        <div class="flex gap-2 items-center">
          <input id="search" placeholder="Ø¨Ø­Ø«..." class="px-3 py-2 rounded-xl border" />
          <button id="ownerBtn" class="px-3 py-2 rounded-xl border">Ù…Ø§Ù„ÙƒØŸ</button>
          <button id="addBtn" class="hidden px-3 py-2 rounded-xl text-white bg-gradient-to-r from-cyan-500 to-blue-600">+ Ø£Ø¶Ù Ø£ÙØªØ§Ø±</button>
        </div>
      </div>
    </header>

    <main class="max-w-5xl mx-auto px-4 py-6 space-y-10">
      <!-- Gallery -->
      <section>
        <div id="grid" class="grid grid-cols-1 sm:grid-cols-2 md:grid-cols-3 gap-5"></div>
        <p id="empty" class="text-center text-gray-500 py-12 hidden">Ù„Ø§ ØªÙˆØ¬Ø¯ Ø¹Ù†Ø§ØµØ±</p>
      </section>

      <!-- Help Section -->
      <section class="rounded-2xl border bg-white/70 p-5">
        <h2 class="text-lg font-bold mb-3">ğŸ“Œ Ø®Ø·ÙˆØ§Øª Ø§Ù„Ù†Ø´Ø± Ø¹Ù„Ù‰ GitHub Pages + Ø­Ù„ÙˆÙ„ Ø§Ù„Ù…Ø´Ø§ÙƒÙ„</h2>

        <details open class="mb-3">
          <summary class="font-semibold">Ø§Ù„Ø®ÙŠØ§Ø± A (Ø£Ù†ØµØ­ Ø¨Ù‡) â€” Ù…Ø³ØªÙˆØ¯Ø¹ Ù…Ø³ØªØ®Ø¯Ù…: <span class="code">TRAGOa.github.io</span></summary>
          <ol class="list-decimal list-inside mt-2 space-y-1 text-sm text-gray-700">
            <li>Ø£Ù†Ø´Ø¦ Ù…Ø³ØªÙˆØ¯Ø¹ Ø¬Ø¯ÙŠØ¯ Ø¨Ø§Ø³Ù… <span class="code">TRAGOa.github.io</span> (Ù†ÙØ³ Ø§Ø³Ù… Ù…Ø³ØªØ®Ø¯Ù…Ùƒ Ø¨Ø§Ù„Ø¶Ø¨Ø·).</li>
            <li>Ø§Ø±ÙØ¹ Ù‡Ø°Ø§ Ø§Ù„Ù…Ù„Ù <b>index.html</b> (Ù…Ù† Ù‡Ø°Ø§ Ø§Ù„Ù…Ø´Ø±ÙˆØ¹).</li>
            <li>Ø§ÙØªØ­ Ø§Ù„Ø±Ø§Ø¨Ø·: <span class="code">https://TRAGOa.github.io/</span> â€” Ø§Ù„Ù…ÙˆÙ‚Ø¹ ÙŠØ´ØªØºÙ„ Ù…Ø¨Ø§Ø´Ø±Ø© 24/7.</li>
          </ol>
        </details>

        <details class="mb-3">
          <summary class="font-semibold">Ø§Ù„Ø®ÙŠØ§Ø± B â€” Ø¯Ø§Ø®Ù„ Ù…Ø³ØªÙˆØ¯Ø¹ Ø¹Ø§Ø¯ÙŠ: <span class="code">trago-avatar</span></summary>
          <ol class="list-decimal list-inside mt-2 space-y-1 text-sm text-gray-700">
            <li>Ø£Ù†Ø´Ø¦ Ù…Ø³ØªÙˆØ¯Ø¹ Ø¨Ø§Ø³Ù… <span class="code">trago-avatar</span> ÙˆØ§Ø±ÙØ¹ <b>index.html</b> ÙÙŠ Ø§Ù„Ø¬Ø°Ø±.</li>
            <li>Settings â†’ Pages â†’ Build and deployment: <b>Deploy from a branch</b>ØŒ Ø§Ù„ÙØ±Ø¹ <span class="code">main</span> ÙˆØ§Ù„Ù…Ø¬Ù„Ø¯ <span class="code">/ (root)</span>.</li>
            <li>Ø§Ù„Ø±Ø§Ø¨Ø·: <span class="code">https://tragoa.github.io/trago-avatar/</span></li>
          </ol>
        </details>

        <details class="mb-3">
          <summary class="font-semibold">Ù„Ùˆ Ø·Ù„Ø¹Øª Ø´Ø§Ø´Ø© Ø±Ù…Ø§Ø¯ÙŠØ©/ÙØ§Ø¶ÙŠØ©</summary>
          <ul class="list-disc list-inside mt-2 space-y-1 text-sm text-gray-700">
            <li>ØªØ£ÙƒØ¯ Ø£Ù† Ø§Ù„Ù…Ù„Ù Ø§Ø³Ù…Ù‡ Ø¨Ø§Ù„Ø¶Ø¨Ø· <b>index.html</b>.</li>
            <li>Ø¬Ø±Ø¨ ØªØ­Ø¯ÙŠØ« Ù‚ÙˆÙŠ: <span class="code">Ctrl + F5</span> (Ø£Ùˆ Ø§Ù…Ø³Ø­ Ø§Ù„ÙƒØ§Ø´).</li>
            <li>Ø§ÙØªØ­ Ø£Ø¯ÙˆØ§Øª Ø§Ù„Ù…Ø·ÙˆØ± (F12) â†’ Console/Network:
              <ul class="list-disc list-inside ms-6">
                <li>Ù„Ùˆ ØªØ´ÙˆÙ 404 Ø¹Ù„Ù‰ Ù…Ø³Ø§Ø± <span class="code">/assets/â€¦</span> ÙÙ…Ø¹Ù†Ø§Ù‡ Ø£Ù†Ùƒ Ø±ÙØ¹Øª Ù…Ø´Ø±ÙˆØ¹ Vite ØºÙŠØ± Ù…Ø¨Ù†ÙŠ Ø£Ùˆ Ø§Ù„Ù…Ø³Ø§Ø± ØºÙ„Ø·.</li>
                <li>Ø§Ù„Ø­Ù„ Ø§Ù„Ø³Ø±ÙŠØ¹: Ø§Ø³ØªØ®Ø¯Ù… Ù‡Ø°Ø§ Ø§Ù„Ù…Ù„Ù Ø§Ù„Ø£Ø­Ø§Ø¯ÙŠ ÙÙ‚Ø· (Ù…Ø§ ÙŠØ­ØªØ§Ø¬ Ø¨Ù†Ø§Ø¡).</li>
              </ul>
            </li>
          </ul>
        </details>

        <details>
          <summary class="font-semibold">Ù…Ù„Ø§Ø­Ø¸Ø§Øª Ù…Ù‡Ù…Ø©</summary>
          <ul class="list-disc list-inside mt-2 space-y-1 text-sm text-gray-700">
            <li>Ø²Ø± <b>Ù…Ø§Ù„ÙƒØŸ</b> ÙŠÙØªØ­ Ø£Ø¯ÙˆØ§Øª Ø§Ù„Ø¥Ø¶Ø§ÙØ© Ø¨Ø±Ù…Ø²Ùƒ: <span class="code">102361</span>.</li>
            <li>Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª ØªÙØ­ÙØ¸ ÙÙŠ Ù…ØªØµÙØ­Ùƒ ÙÙ‚Ø· Ø¹Ø¨Ø± <span class="code">localStorage</span> (Ù…Ø¤Ù‚Øª Ù„Ùƒ). Ù„Ùˆ ØªØ¨ÙŠÙ‡Ø§ ØªØ¸Ù‡Ø± Ù„Ù„ÙƒÙ„ Ø¨Ø´ÙƒÙ„ Ø¯Ø§Ø¦Ù…ØŒ Ø£Ø¹Ø·Ù†ÙŠ Ø®Ø¨Ø± ÙˆØ£Ø¶ÙŠÙ Ø²Ø± <b>ØªØµØ¯ÙŠØ±/Ø§Ø³ØªÙŠØ±Ø§Ø¯ JSON</b>.</li>
          </ul>
        </details>
      </section>
    </main>

    <footer class="border-t py-6 text-center text-sm text-gray-500">
      Â© <span id="year"></span> TRAGO â€¢ Designed by Majoodi
    </footer>

    <!-- Lightbox -->
    <div id="lightbox" class="hidden fixed inset-0 z-50 bg-black/80 flex items-center justify-center p-4">
      <div class="relative w-full max-w-4xl" onclick="event.stopPropagation()">
        <img id="lbImg" src="" class="w-full max-h-[80vh] object-contain rounded-2xl shadow-lg" />
        <div class="mt-4 flex justify-between items-center text-white">
          <div class="flex gap-2">
            <button id="prev" class="px-3 py-2 rounded-xl bg-white/10 hover:bg-white/20">â†</button>
            <button id="next" class="px-3 py-2 rounded-xl bg-white/10 hover:bg-white/20">â†’</button>
          </div>
          <div class="flex gap-2">
            <a id="lbLink" target="_blank" class="px-4 py-2 bg-gradient-to-r from-cyan-400 to-blue-600 rounded-xl font-semibold">VRChat â†—</a>
            <button id="close" class="px-4 py-2 rounded-xl bg-white/10 hover:bg-white/20">âœ•</button>
          </div>
        </div>
      </div>
    </div>

    <!-- Add Modal -->
    <div id="modal" class="hidden fixed inset-0 z-50 bg-black/50 flex items-center justify-center p-4">
      <div class="w-full max-w-lg bg-white rounded-2xl p-5 border" onclick="event.stopPropagation()">
        <h3 class="text-lg font-bold mb-3">Ø¥Ø¶Ø§ÙØ© Ø£ÙØªØ§Ø±</h3>
        <input id="mName" class="w-full p-2 rounded-xl mb-2 border" placeholder="Ø§Ø³Ù… Ø§Ù„Ø£ÙØªØ§Ø±" />
        <input id="mLink" class="w-full p-2 rounded-xl mb-2 border" placeholder="Ø±Ø§Ø¨Ø· VRChat" />
        <textarea id="mImgs" class="w-full p-2 rounded-xl mb-2 border h-28" placeholder="Ø±ÙˆØ§Ø¨Ø· Ø§Ù„ØµÙˆØ± (Ø³Ø·Ø± Ù„ÙƒÙ„ ØµÙˆØ±Ø©)"></textarea>
        <div class="flex justify-end gap-2">
          <button id="mCancel" class="px-4 py-2 rounded-xl border">Ø¥Ù„ØºØ§Ø¡</button>
          <button id="mSave" class="px-4 py-2 rounded-xl text-white bg-gradient-to-r from-cyan-500 to-blue-600">Ø­ÙØ¸</button>
        </div>
      </div>
    </div>

<script>
  const OWNER_CODE = "102361";
  const KEY = "trago_items";
  const year = document.getElementById('year'); year.textContent = new Date().getFullYear();

  const defaultItems = [
    {
      id: "trago-main",
      name: "TRAGO AVATAR â€” Signature",
      vrchat: "https://vrchat.com/home/avatar/xxxxxxxx",
      images: [
        "https://images.unsplash.com/photo-1557264337-e8a93017fe92?w=1600&q=60&auto=format&fit=crop",
        "https://images.unsplash.com/photo-1542751110-97427bbecf20?w=1600&q=60&auto=format&fit=crop"
      ],
      createdAt: new Date().toISOString().slice(0,10)
    }
  ];

  const state = {
    items: [], owner: false, query: "", picked: null, pickedIdx: 0
  };

  function load() {
    try {
      const raw = localStorage.getItem(KEY);
      state.items = raw ? JSON.parse(raw) : defaultItems;
    } catch {
      state.items = defaultItems;
    }
  }
  function save() {
    localStorage.setItem(KEY, JSON.stringify(state.items));
  }

  const grid = document.getElementById('grid');
  const empty = document.getElementById('empty');
  const search = document.getElementById('search');
  const ownerBtn = document.getElementById('ownerBtn');
  const addBtn = document.getElementById('addBtn');

  function card(item) {
    const d = document.createElement('div');
    d.className = "rounded-2xl overflow-hidden border bg-white shadow hover:shadow-lg transition";
    d.innerHTML = `
      <button class="text-right w-full" data-open="${item.id}">
        <img src="${item.images?.[0] || ''}" class="w-full h-56 object-cover" alt="${item.name}"/>
        <div class="p-4">
          <h3 class="text-lg font-bold">${item.name}</h3>
          <p class="text-xs text-gray-500 mt-1">${item.createdAt}</p>
          <a href="${item.vrchat}" target="_blank" class="inline-block mt-3 px-3 py-1 rounded-xl text-white bg-gradient-to-r from-cyan-400 to-blue-600">VRChat â†—</a>
        </div>
      </button>`;
    d.querySelector('button').onclick = () => openLightbox(item);
    return d;
  }

  function render() {
    grid.innerHTML = "";
    const q = state.query.toLowerCase();
    const list = state.items.filter(i => !q || i.name.toLowerCase().includes(q));
    if (list.length === 0) { empty.classList.remove('hidden'); return; }
    empty.classList.add('hidden');
    list.forEach(i => grid.appendChild(card(i)));
    addBtn.classList.toggle('hidden', !state.owner);
  }

  // Lightbox
  const lb = document.getElementById('lightbox');
  const lbImg = document.getElementById('lbImg');
  const lbLink = document.getElementById('lbLink');
  document.getElementById('close').onclick = closeLightbox;
  document.getElementById('prev').onclick = () => step(-1);
  document.getElementById('next').onclick = () => step(+1);
  lb.onclick = closeLightbox;

  function openLightbox(item) {
    state.picked = item; state.pickedIdx = 0;
    lbImg.src = item.images[0]; lbLink.href = item.vrchat;
    lb.classList.remove('hidden');
  }
  function closeLightbox(){ lb.classList.add('hidden'); state.picked=null; }
  function step(dir){
    if(!state.picked) return;
    const n = state.picked.images.length;
    state.pickedIdx = (state.pickedIdx + dir + n) % n;
    lbImg.src = state.picked.images[state.pickedIdx];
  }

  // Owner
  ownerBtn.onclick = () => {
    if (state.owner) { state.owner = false; addBtn.classList.add('hidden'); alert('ØªÙ… Ø§Ù„Ø®Ø±ÙˆØ¬'); return; }
    const code = prompt('Ø£Ø¯Ø®Ù„ Ø±Ù…Ø² Ø§Ù„Ù…Ø§Ù„Ùƒ:');
    if (code === OWNER_CODE) { state.owner = true; addBtn.classList.remove('hidden'); alert('ØªÙ… Ø§Ù„Ø¯Ø®ÙˆÙ„'); }
    else alert('Ø§Ù„Ø±Ù…Ø² ØºÙŠØ± ØµØ­ÙŠØ­');
  };

  // Add Modal
  const modal = document.getElementById('modal');
  const mName = document.getElementById('mName');
  const mLink = document.getElementById('mLink');
  const mImgs = document.getElementById('mImgs');
  document.getElementById('mCancel').onclick = () => modal.classList.add('hidden');
  document.getElementById('mSave').onclick = () => {
    const name = mName.value.trim();
    const vrchat = mLink.value.trim();
    const imgs = mImgs.value.split(/\n|,\s*/).map(s=>s.trim()).filter(Boolean);
    if(!name || !vrchat || imgs.length === 0) return alert('Ø§Ù…Ù„Ø£ Ø§Ù„Ø­Ù‚ÙˆÙ„');
    const obj = { id: name.toLowerCase().replace(/[^a-z0-9]+/g,'-').slice(0,40), name, vrchat, images: imgs, createdAt: new Date().toISOString().slice(0,10)};
    state.items.unshift(obj); save(); modal.classList.add('hidden'); mName.value=''; mLink.value=''; mImgs.value=''; render();
  };
  addBtn.onclick = () => modal.classList.remove('hidden');

  // Search
  search.oninput = () => { state.query = search.value; render(); };

  // Init
  load(); render();
</script>
  </body>
</html>
